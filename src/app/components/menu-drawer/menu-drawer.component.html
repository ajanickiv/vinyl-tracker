<div class="drawer-container" [class.open]="isOpen()">
  <!-- Backdrop -->
  <div class="backdrop" (click)="onBackdropClick()"></div>

  <!-- Drawer -->
  <div class="drawer">
    <div class="drawer-header">
      <h2>Menu</h2>
      <button class="close-button" (click)="closeDrawer()">âœ•</button>
    </div>

    <div class="drawer-content">
      <!-- Sync Section -->
      <div class="menu-section">
        <h3>Collection Sync</h3>
        <div class="sync-info">
          <p class="sync-status">
            Last synced: <strong>{{ getTimeSinceSync() }}</strong>
          </p>
          <button class="resync-button" (click)="resync()" [disabled]="syncing()">
            <span class="button-icon">â†»</span>
            {{ syncing() ? 'Syncing...' : 'Re-sync from Discogs' }}
          </button>
          @if (syncMessage()) {
            <p class="sync-message">{{ syncMessage() }}</p>
          }
        </div>
      </div>

      <!-- Stats Section -->
      @if (collectionStats(); as stats) {
        <div class="menu-section">
          <h3>Collection Stats</h3>
          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-value">{{ stats.totalReleases }}</div>
              <div class="stat-label">Total Releases</div>
            </div>
            <div class="stat-item">
              <div class="stat-value">{{ stats.totalPlays }}</div>
              <div class="stat-label">Total Plays</div>
            </div>
            <div class="stat-item">
              <div class="stat-value">{{ stats.neverPlayed }}</div>
              <div class="stat-label">Never Played</div>
            </div>
            <div class="stat-item">
              <div class="stat-value">
                {{
                  stats.totalReleases > 0
                    ? (
                        ((stats.totalReleases - stats.neverPlayed) / stats.totalReleases) *
                        100
                      ).toFixed(0)
                    : 0
                }}%
              </div>
              <div class="stat-label">Collection Played</div>
            </div>
          </div>
        </div>

        @if (stats.mostPlayed; as mostPlayed) {
          <div class="menu-section">
            <h3>Most Played</h3>
            <div class="album-highlight">
              <p class="album-title">{{ mostPlayed.basicInfo.title }}</p>
              <p class="album-artist">
                {{ mostPlayed.basicInfo.artists.join(', ') }}
              </p>
              <p class="play-count">{{ mostPlayed.playCount }} plays</p>
            </div>
          </div>
        }
      }

      <!-- Dev Tools Section (only in dev mode) -->
      @if (isDevMode) {
        <div class="menu-section dev-section">
          <h3>Dev Tools</h3>
          <div class="dev-info">
            <p class="dev-warning">These options are only visible in development mode.</p>
            <button class="clear-button" (click)="clearData()" [disabled]="clearing()">
              <span class="button-icon">ðŸ—‘</span>
              {{ clearing() ? 'Clearing...' : 'Clear All Data' }}
            </button>
          </div>
        </div>
      }
    </div>
  </div>
</div>
